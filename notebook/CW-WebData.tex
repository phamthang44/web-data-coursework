% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={CW-WebData},
  pdfauthor={Pham Duc Thang},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{CW-WebData}
\author{Pham Duc Thang}
\date{2025-07-07}

\begin{document}
\maketitle

\section{Task 1a - Comparative Analysis of Traffic
Sources}\label{task-1a---comparative-analysis-of-traffic-sources}

\subsection{Step 0 : Load library}\label{step-0-load-library}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v dplyr     1.1.4     v readr     2.1.5
## v forcats   1.0.0     v stringr   1.5.1
## v ggplot2   3.5.2     v tibble    3.2.1
## v lubridate 1.9.4     v tidyr     1.3.1
## v purrr     1.0.4     
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readr)}
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(scales)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'scales'
## 
## The following object is masked from 'package:purrr':
## 
##     discard
## 
## The following object is masked from 'package:readr':
## 
##     col_factor
\end{verbatim}

\subsection{Step 1 : Load data}\label{step-1-load-data}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"../data/Web Analytic\_Dataset.csv"}\NormalTok{)}
\NormalTok{data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        Source...Medium Year Month.of.the.year   Users New.Users Sessions
## 1                    A 2019                11 126,870   104,020  194,667
## 2                    A 2020                 5 120,625    98,574  194,114
## 3                    A 2019                10 123,361   104,308  181,175
## 4                    A 2019                 9 106,551    88,428  170,329
## 5                    A 2020                 6 102,123    82,461  163,446
## 6                    A 2019                12  91,043    70,326  142,637
## 7                    A 2020                 1  83,031    64,103  133,736
## 8                    A 2020                 7  84,343    73,239  125,423
## 9                    A 2020                 2  82,626    68,145  125,318
## 10                   A 2020                 3  73,844    61,557  110,546
## 11                   B 2019                12  88,579    75,361  106,966
## 12                   A 2020                 4  73,349    62,794  104,146
## 13                   C 2020                 5  68,869    55,769   99,838
## 14                   B 2020                 1  82,671    72,520   99,500
## 15                   B 2019                11  79,783    65,883   98,400
## 16                   D 2020                 5  82,246    81,585   90,447
## 17                   B 2020                 2  69,129    58,861   82,905
## 18                   B 2019                10  65,953    55,972   80,301
## 19                   C 2020                 4  50,516    43,034   74,190
## 20                   B 2020                 5  55,342    48,064   66,180
## 21                   E 2019                10  33,658     4,533   62,972
## 22                   B 2020                 6  50,645    44,609   60,789
## 23                   B 2020                 3  48,288    41,139   58,580
## 24                   A 2020                 8  42,747    35,935   56,931
## 25                   E 2019                11  31,370     3,721   55,292
## 26                   C 2020                 6  36,191    27,156   51,894
## 27                   B 2020                 7  43,010    38,395   50,567
## 28                   B 2020                 8  42,815    38,735   50,550
## 29                   B 2019                 9  40,697    34,012   48,854
## 30                   F 2020                 7  42,982    42,730   45,898
## 31                   C 2020                 3  25,294    20,428   40,622
## 32                   E 2019                12  23,435     4,284   39,880
## 33                   E 2019                 9  21,325     2,547   37,821
## 34                   E 2020                 2  20,448     3,180   37,225
## 35                   B 2020                 4  29,989    24,981   36,920
## 36                   C 2020                 1  24,971    19,962   35,064
## 37                   E 2020                 3  17,879     3,588   33,009
## 38                   G 2020                 5  19,478     2,467   31,066
## 39                   E 2020                 4  17,620     3,586   30,386
## 40                   C 2020                 2  18,990    14,703   28,625
## 41                   G 2020                 6  16,773     2,491   27,754
## 42                   H 2019                 9  19,078    15,188   26,330
## 43                   H 2019                10  19,263    15,538   26,057
## 44                   E 2020                 1  14,803     1,386   25,031
## 45                   I 2019                10  13,150     9,316   24,291
## 46                   H 2019                11  16,826    13,098   23,791
## 47                   D 2020                 6  15,117    14,145   22,828
## 48                   H 2019                12  16,312    13,243   21,409
## 49                   I 2019                11  11,522     7,923   21,191
## 50                   G 2020                 7  10,277     1,708   17,149
## 51                   I 2019                 9   8,772     5,675   16,799
## 52                   F 2020                 5  12,284    11,569   16,326
## 53                   F 2020                 6  12,324    11,664   16,149
## 54                   I 2019                12  10,275     7,523   15,686
## 55                   C 2020                 8  11,946     8,525   15,172
## 56                   F 2019                12  12,351    11,794   14,797
## 57                   C 2020                 7   9,930     6,789   13,141
## 58                   F 2019                10   9,099     8,747   11,405
## 59                   F 2020                 1   8,964     8,481   11,113
## 60                   G 2020                 8   6,686     1,241   11,018
## 61                   F 2020                 4   8,078     7,512   10,890
## 62                   F 2020                 2   8,055     7,467   10,375
## 63                   F 2019                11   7,869     7,463   10,252
## 64                   D 2020                 7   7,215     6,676   10,101
## 65                   J 2020                 5   9,414     8,590    9,928
## 66                   F 2020                 8   7,737     7,317    9,849
## 67                   F 2020                 3   7,298     6,694    9,583
## 68                   I 2020                 5   5,933     1,852    8,437
## 69                   F 2019                 9   5,824     5,518    7,349
## 70                   K 2019                12   5,851     4,826    7,200
## 71                   K 2019                11   5,204     4,484    6,540
## 72                   E 2020                 5   4,328       637    6,497
## 73                   C 2019                12   4,701     3,245    6,079
## 74                   L 2020                 1   2,249        26    5,699
## 75                   L 2020                 2   2,016        20    5,357
## 76                   K 2019                10   4,627     4,161    5,352
## 77                   M 2019                 9   3,504     2,184    4,882
## 78                   N 2020                 5   4,224     4,151    4,822
## 79                   M 2019                10   2,824     1,701    4,150
## 80                   L 2019                11   1,830        31    4,060
## 81                   L 2019                12   1,890        18    4,033
## 82                   K 2019                 9   3,345     3,031    3,721
## 83                   O 2020                 6   1,422        20    3,714
## 84                   L 2019                10   1,528        11    3,703
## 85                   O 2020                 5   1,491        13    3,595
## 86                   P 2020                 6   3,114     2,655    3,457
## 87                   P 2020                 7   2,997     2,602    3,368
## 88                   M 2019                11   2,251     1,262    3,265
## 89                   P 2020                 5   2,773     2,289    3,189
## 90                   C 2019                 9   2,805     2,243    3,121
## 91                   P 2020                 1   2,688     2,089    2,978
## 92                   R 2019                10   2,033     1,523    2,840
## 93                   I 2020                 4   2,537     1,834    2,797
## 94                   R 2019                12   2,045     1,495    2,777
## 95                   M 2019                12   2,202     1,439    2,714
## 96                   P 2020                 2   2,355     1,800    2,637
## 97                   R 2020                 1   1,884     1,298    2,624
## 98                   R 2020                 4   1,688     1,268    2,537
## 99                   S 2020                 5   1,188       585    2,466
## 100                  O 2020                 7     946        20    2,424
## 101                  D 2020                 4   1,965     1,886    2,317
## 102                  R 2020                 2   1,682     1,212    2,274
## 103                  N 2020                 4   2,091     2,072    2,235
## 104                  P 2019                12   1,944     1,528    2,164
## 105                  M 2020                 5   1,724     1,011    2,089
## 106                  M 2020                 6   1,801     1,072    2,065
## 107                  S 2020                 4     991       595    2,012
## 108                  P 2020                 3   1,567     1,183    1,795
## 109                  J 2020                 8   1,698     1,423    1,774
## 110                  D 2020                 8     698       414    1,693
## 111                  R 2019                11   1,282       838    1,683
## 112                  T 2020                 6     888       472    1,633
## 113                  T 2020                 7     865       493    1,628
## 114                  P 2020                 4   1,407     1,121    1,589
## 115                  S 2020                 6     836       436    1,466
## 116                  P 2019                 9   1,332       994    1,465
## 117                  P 2020                 8   1,323     1,100    1,463
## 118                  T 2020                 5     901       558    1,443
## 119                  R 2019                 9   1,070       776    1,420
## 120                  L 2020                 3     618         4    1,417
## 121                  R 2020                 3   1,043       735    1,413
## 122                  I 2020                 3   1,195       735    1,385
## 123                  U 2020                 6     477       193    1,344
## 124                  O 2020                 8     559        14    1,149
## 125                  S 2020                 3     524       282    1,146
## 126                l.M 2019                10     773       417    1,130
## 127                  M 2020                 7     932       597    1,100
## 128                  U 2020                 5     483       237    1,094
## 129                  P 2019                10     977       754    1,082
## 130                  T 2020                 8     703       381    1,050
## 131                l.M 2020                 5     803       364    1,045
## 132                l.K 2020                 5     927       768    1,043
## 133                  K 2020                 6     916       736    1,033
## 134                l.M 2019                 9     691       365    1,020
## 135                  V 2020                 1     903       887      956
## 136                  U 2020                 4     370       178      947
## 137                  Y 2020                 5     913       864      943
## 138                  M 2020                 8     807       593      940
## 139                l.K 2020                 4     827       644      888
## 140                  U 2020                 7     349       151      882
## 141                  S 2020                 7     582       362      864
## 142                l.M 2019                11     633       298      861
## 143                  S 2019                11     453       366      819
## 144                  Z 2019                11     617       533      802
## 145                  S 2020                 2     410       230      786
## 146                 AA 2019                 9     743       710      771
## 147                  C 2019                10     680       442      748
## 148                  Z 2020                 5     616       555      743
## 149                  I 2020                 1     663       433      739
## 150                 BB 2019                 9     255         2      733
## 151                l.K 2019                12     618       523      680
## 152                l.M 2020                 4     547       277      666
## 153                  S 2020                 1     336       213      658
## 154                  K 2020                 7     580       497      650
## 155                  K 2020                 8     575       502      648
## 156                  I 2020                 2     518       251      646
## 157                  M 2020                 4     615       558      644
## 158                 CC 2020                 5     565       402      637
## 159                l.K 2020                 1     543       408      620
## 160                  S 2019                12     375       258      604
## 161                l.M 2019                12     475       243      598
## 162                  Z 2020                 6     488       433      596
## 163                  Z 2020                 1     475       416      573
## 164                  K 2020                 5     486       344      569
## 165                  Z 2020                 4     428       385      564
## 166                  Z 2020                 2     453       404      562
## 167                  Z 2019                10     464       382      560
## 168                  Z 2019                12     448       375      554
## 169                  V 2020                 2     497       471      534
## 170                  S 2019                10     319       237      530
## 171                l.K 2019                11     441       371      512
## 172                l.K 2020                 2     436       346      505
## 173                 DD 2020                 8     320       209      503
## 174                  M 2020                 1     490       467      497
## 175                l.K 2019                 9     441       401      481
## 176                 AA 2019                11     434       391      481
## 177                l.K 2019                10     385       339      479
## 178                  U 2020                 3     200        61      460
## 179                  M 2020                 3     422       384      453
## 180                  Z 2020                 7     367       325      442
## 181                  R 2020                 5     277       145      440
## 182                l.K 2020                 3     386       285      436
## 183                  V 2020                 5     408       388      424
## 184                 lI 2019                10     244       132      422
## 185                  Z 2019                 9     348       293      418
## 186                  U 2020                 2     187        90      401
## 187                  Z 2020                 3     343       293      399
## 188                  V 2020                 3     381       359      394
## 189                  Z 2020                 8     336       301      393
## 190                  M 2020                 2     372       341      387
## 191                 CC 2020                 8     226       116      373
## 192                l.M 2020                 3     293       120      360
## 193                 AA 2019                10     334       294      359
## 194                 AA 2019                12     297       249      336
## 195                  V 2020                 4     318       307      330
## 196                  U 2020                 1     159        83      320
## 197                 CC 2020                 4     254       175      307
## 198                  E 2020                 6     126        24      301
## 199                l.M 2020                 1     250       133      299
## 200                 AA 2020                 1     262       223      296
## 201                 AA 2020                 2     246       204      287
## 202                  S 2019                 9     183       141      283
## 203                 EE 2019                12     124        11      279
## 204                 lI 2019                11     153        73      269
## 205                  U 2019                12     175       104      268
## 206                l.M 2020                 2     215       103      268
## 207                  U 2019                11     194       155      267
## 208                 CC 2020                 6     180        83      255
## 209                 BB 2019                10      86         6      248
## 210                 FF 2019                12     193       171      235
## 211                 FF 2019                11     188       157      223
## 212                 GG 2020                 4     216       213      219
## 213                  U 2019                10     146       114      216
## 214                 HH 2020                 8      81        15      215
## 215                 II 2020                 8     102        24      214
## 216                 lI 2019                12     135        73      211
## 217                 lI 2019                 9     128        62      210
## 218                  H 2020                 1      86        15      206
## 219                 EE 2019                10     114         3      203
## 220                 JJ 2019                11     158       132      198
## 221                 CC 2020                 7     108        47      193
## 222                 FF 2020                 1     140       127      192
## 223                 EE 2019                11     116        13      191
## 224                  L 2020                 4      54         4      191
## 225                 FF 2019                10     162       144      190
## 226                 EE 2020                 1     102        16      186
## 227                 FF 2019                 9     164       153      180
## 228                 AA 2020                 6     132       115      178
## 229                 AA 2020                 3     138       116      173
## 230                  L 2019                 9      86         1      169
## 231                 JJ 2019                10     132       103      169
## 232                  C 2019                11     150        41      168
## 233                 FF 2020                 2     127       107      156
## 234                 BB 2019                11      41         1      152
## 235                  E 2020                 7      73        18      149
## 236                  K 2020                 1     123        71      147
## 237                 EE 2020                 2      87        16      146
## 238                 FF 2020                 5     120       106      140
## 239                 FF 2020                 6     119       104      139
## 240                  K 2020                 4     123        76      137
## 241                  U 2019                 9      90        83      137
## 242                 KK 2020                 5     119       112      135
## 243                 JJ 2020                 1      94        71      135
## 244                 EE 2019                 9      77         3      133
## 245                 JJ 2020                 5     109        91      132
## 246                 AA 2020                 5     111        97      131
## 247                  K 2020                 2     112        81      130
## 248                 JJ 2019                12     117        90      129
## 249                  K 2020                 3     111        70      127
## 250 euromessage / push 2020                 5      99         1      125
##     Bounce.Rate Pageviews Avg..Session.Duration Conversion.Rate....
## 1        71.59%   455,159              00:01:11                 0.2
## 2        64.56%   559,509              00:01:32                0.69
## 3        41.91%   368,907              00:01:05                0.26
## 4        75.92%   368,803              00:01:01                0.18
## 5        67.10%   425,410              00:01:20                 0.7
## 6        67.06%   370,798              00:01:20                0.34
## 7        69.46%   373,356              00:01:23                0.45
## 8        71.16%   292,263              00:01:12                0.58
## 9        70.06%   328,822              00:01:24                0.52
## 10       72.19%   266,187              00:01:15                0.48
## 11       56.20%   333,480              00:01:55                0.21
## 12       67.12%   288,195              00:01:25                 0.6
## 13       50.98%   325,311              00:01:38                0.47
## 14       60.96%   299,723              00:01:48                0.25
## 15       55.17%   342,257              00:02:13                0.22
## 16       86.13%   111,745              00:00:26                   0
## 17       61.34%   238,736              00:01:51                0.35
## 18       36.72%   263,957              00:02:14                0.33
## 19       50.75%   247,484              00:01:35                0.38
## 20       58.30%   213,302              00:02:07                0.52
## 21       34.04%   164,136              00:01:46                0.25
## 22       60.44%   181,511              00:01:58                0.53
## 23       61.19%   174,115              00:02:00                0.31
## 24       64.81%   149,505              00:01:29                0.48
## 25       62.09%   143,387              00:01:42                0.16
## 26       49.67%   167,903              00:01:37                 0.7
## 27       62.29%   140,013              00:01:54                0.38
## 28       63.45%   135,664              00:01:48                 0.4
## 29       55.57%   178,347              00:02:16                0.24
## 30       86.25%    78,133              00:00:34                0.15
## 31       53.76%   121,931              00:01:28                0.51
## 32       58.84%   103,506              00:01:39                0.34
## 33       59.75%   107,063              00:01:48                0.22
## 34       61.91%    98,988              00:01:47                0.49
## 35       54.52%   139,743              00:02:42                 0.6
## 36       69.74%    84,740              00:01:03                0.26
## 37       59.26%    93,181              00:01:51                0.56
## 38       57.09%    89,816              00:01:46                 0.6
## 39       53.27%   100,807              00:02:00                0.62
## 40       61.56%    75,117              00:01:20                0.45
## 41       56.15%    80,190              00:01:44                0.73
## 42       62.39%    66,331              00:01:31                0.11
## 43       39.86%    64,175              00:01:30                0.07
## 44       63.55%    66,722              00:01:42                0.34
## 45       27.49%    63,230              00:01:23                0.24
## 46       66.31%    55,191              00:01:22                0.08
## 47       85.94%    27,839              00:00:48               <0.01
## 48       59.83%    50,408              00:01:26                0.11
## 49       55.92%    59,438              00:01:24                0.23
## 50       55.92%    49,644              00:01:46                0.84
## 51       57.71%    46,301              00:01:19                0.25
## 52       55.57%    55,340              00:02:28                0.69
## 53       59.48%    48,908              00:01:51                0.55
## 54       54.54%    44,207              00:01:21                0.31
## 55       54.73%    44,710              00:01:29                0.45
## 56       54.76%    50,265              00:02:08                0.39
## 57       52.42%    42,336              00:01:41                0.43
## 58       31.19%    31,980              00:02:28                0.39
## 59       60.41%    38,427              00:02:20                0.55
## 60       55.41%    33,737              00:01:54                0.77
## 61       59.39%    37,074              00:02:40                0.57
## 62       58.28%    35,176              00:02:22                0.61
## 63       53.63%    38,871              00:02:50                0.49
## 64       87.07%    12,415              00:00:40                   0
## 65       58.97%    25,042              00:01:17                0.23
## 66       54.26%    31,573              00:01:59                0.39
## 67       60.92%    30,567              00:02:15                0.42
## 68       44.39%    34,162              00:02:09                 1.3
## 69       53.63%    28,215              00:02:52                1.86
## 70       44.36%    27,226              00:01:41                 0.1
## 71       45.18%    24,275              00:01:38                0.05
## 72       53.50%    22,742              00:02:22                0.68
## 73       69.45%    12,912              00:00:54                0.26
## 74       79.03%    10,421              00:00:58                0.09
## 75       79.65%     9,440              00:00:59                0.09
## 76       30.36%    20,371              00:01:45                0.11
## 77       56.47%    16,125              00:01:59                 0.2
## 78       82.81%     7,727              00:00:42                   0
## 79       29.76%    15,145              00:02:14                0.14
## 80       79.16%     8,122              00:01:14                0.12
## 81       72.95%    10,040              00:02:03                0.17
## 82       50.28%    11,704              00:01:16                   0
## 83       75.71%     7,597              00:01:33                0.03
## 84       55.14%     7,678              00:01:16                   0
## 85       70.93%     9,164              00:01:56                0.14
## 86       63.12%     8,551              00:01:42                0.58
## 87       64.34%     7,758              00:01:34                0.24
## 88       50.23%    12,367              00:02:28                0.12
## 89       63.94%     8,462              00:02:00                0.44
## 90       49.98%    11,136              00:01:45                0.13
## 91       73.98%     5,905              00:01:21                0.34
## 92       37.11%    11,116              00:02:54                0.25
## 93       59.81%    12,348              00:02:27                1.32
## 94       51.24%    10,627              00:02:14                0.11
## 95       52.47%     8,588              00:02:02                0.26
## 96       73.00%     5,229              00:01:22                0.42
## 97       47.60%    11,183              00:03:00                0.42
## 98       52.98%     9,793              00:03:13                 0.2
## 99       25.43%     7,721              00:04:09               31.75
## 100      74.59%     5,082              00:01:45                0.12
## 101      83.25%     3,173              00:00:40                   0
## 102      49.82%     9,928              00:03:39                0.48
## 103      85.68%     3,321              00:00:26                   0
## 104      70.89%     4,480              00:01:15                0.23
## 105      56.15%     8,703              00:02:46                1.29
## 106      45.71%    10,277              00:02:55                2.76
## 107      17.59%     6,184              00:04:35               36.18
## 108      71.31%     3,616              00:01:30                0.39
## 109      58.96%     4,714              00:01:13                0.23
## 110      87.71%     1,988              00:01:05                   0
## 111      50.27%     7,043              00:02:46                0.12
## 112      35.70%     9,451              00:04:54                0.86
## 113      40.79%     8,510              00:04:47                0.61
## 114      65.14%     4,272              00:02:05                0.63
## 115      18.01%     4,785              00:04:51               38.61
## 116      67.65%     3,204              00:01:37                0.27
## 117      60.36%     3,756              00:02:04                0.62
## 118      38.05%     7,391              00:03:57                0.69
## 119      45.56%     7,522              00:04:16                0.28
## 120      80.52%     2,432              00:01:05                0.14
## 121      47.91%     6,289              00:04:27                1.13
## 122      53.86%     6,808              00:02:53                1.88
## 123      47.17%     2,716              00:02:20               17.11
## 124      77.11%     2,208              00:01:52                   0
## 125      25.39%     2,680              00:03:55               31.76
## 126      27.08%     5,233              00:02:54                   0
## 127      46.09%     5,477              00:03:19                3.73
## 128      29.25%     2,474              00:03:01               24.59
## 129       5.55%     2,142              00:01:47                0.18
## 130      44.00%     4,457              00:03:40                0.38
## 131      24.69%     6,864              00:04:37                1.15
## 132      14.96%     7,017              00:03:49                0.77
## 133      21.88%     5,691              00:03:10                0.97
## 134      46.96%     4,222              00:02:24                 0.2
## 135      54.60%     2,652              00:01:07                   0
## 136      33.69%     2,062              00:03:13               26.61
## 137      61.61%     2,576              00:01:36                   0
## 138      57.23%     4,219              00:02:43                3.83
## 139      14.19%     5,689              00:03:41                0.68
## 140      49.09%     1,687              00:02:10               17.57
## 141      11.46%     2,702              00:04:32               40.05
## 142      42.51%     3,634              00:02:39                0.23
## 143      12.94%     4,360              00:04:51               31.38
## 144      43.14%     4,003              00:03:22                   0
## 145      33.33%     1,642              00:03:00               26.72
## 146      63.29%     1,581              00:03:52                   0
## 147      19.65%     3,300              00:02:22                0.53
## 148      47.24%     3,958              00:04:11                0.81
## 149      46.41%     4,424              00:03:12                0.54
## 150      80.63%     1,376              00:01:08                0.14
## 151      13.38%     4,625              00:03:27                0.29
## 152      10.51%     5,878              00:05:49                0.75
## 153      25.08%     1,539              00:03:51                26.6
## 154      18.92%     3,616              00:03:31                0.46
## 155      18.06%     3,667              00:03:18                0.31
## 156      28.33%     4,553              00:04:13                2.48
## 157      84.63%     1,397              00:01:09                0.78
## 158      39.56%     3,109              00:03:25                5.81
## 159      12.58%     5,096              00:04:14                0.65
## 160      11.92%     1,436              00:04:00               26.66
## 161      31.94%     3,164              00:03:22                0.17
## 162      48.49%     2,108              00:03:00                0.67
## 163      49.21%     2,300              00:03:04                   0
## 164      34.27%     2,628              00:02:23                0.53
## 165      51.06%     2,263              00:02:55                0.35
## 166      50.71%     2,264              00:02:50                0.71
## 167      31.25%     2,602              00:02:57                0.36
## 168      43.32%     3,014              00:03:49                0.72
## 169      53.37%     1,281              00:01:10                0.19
## 170       6.98%     2,883              00:04:48               42.08
## 171      15.04%     3,416              00:04:03                   0
## 172      12.67%     3,266              00:03:55                 0.2
## 173      41.15%     2,357              00:05:22                1.79
## 174      91.75%       748              00:00:23                   0
## 175      14.35%     2,614              00:02:44                   0
## 176      62.79%     1,171              00:01:45                   0
## 177      13.36%     2,794              00:04:28                0.42
## 178      35.65%       966              00:03:16               22.17
## 179      86.53%       999              00:01:13                0.44
## 180      52.26%     1,572              00:02:54                0.68
## 181      43.41%     2,209              00:04:24                0.45
## 182      13.76%     2,657              00:04:00                0.23
## 183      61.56%     1,034              00:01:21                   0
## 184      25.83%     1,122              00:01:40                0.24
## 185      47.85%     1,931              00:02:59                0.96
## 186      28.18%       856              00:02:41               22.69
## 187      47.37%     1,509              00:03:00                   1
## 188      52.54%     1,035              00:01:21                0.25
## 189      54.20%     1,234              00:02:33                0.25
## 190      87.86%       736              00:00:52                0.52
## 191      24.66%     2,475              00:04:59                4.83
## 192      14.17%     2,956              00:05:57                2.22
## 193      43.73%       969              00:02:09                   0
## 194      55.06%       862              00:02:00                   0
## 195      57.27%       929              00:01:31                   0
## 196      35.94%       604              00:03:01               24.38
## 197      28.01%     2,249              00:05:38                7.82
## 198      63.12%       902              00:02:13                   0
## 199      14.05%     2,424              00:04:26                1.67
## 200      56.08%       870              00:02:20                   0
## 201      56.45%       849              00:02:30                   0
## 202      12.37%     1,646              00:05:28               33.22
## 203      34.77%     1,380              00:04:01                4.66
## 204      57.99%       678              00:01:36                0.37
## 205      19.78%       478              00:02:56               26.12
## 206      11.94%     2,001              00:04:33                1.87
## 207       0.00%       827              00:03:32               20.22
## 208      38.04%     1,234              00:03:49                7.45
## 209      46.77%       449              00:01:12                   0
## 210      38.72%     1,581              00:03:51                0.85
## 211      47.98%       828              00:02:44                 0.9
## 212      98.63%       237              00:00:02                   0
## 213       0.00%       722              00:04:06               31.02
## 214      25.58%     1,389              00:05:18                 1.4
## 215      42.06%       986              00:04:37                 1.4
## 216      54.98%       632              00:01:32                   0
## 217      53.33%       687              00:02:07                   0
## 218      83.98%       279              00:00:42                   0
## 219      24.14%     1,188              00:04:58                2.96
## 220      33.84%     1,388              00:03:55                   0
## 221      36.79%     1,007              00:04:02                6.74
## 222      50.52%       893              00:02:52                0.52
## 223      26.18%     1,277              00:05:20                3.66
## 224      75.92%       287              00:01:27                   0
## 225      41.58%       720              00:01:55                   0
## 226      39.25%       983              00:03:36                7.53
## 227      57.78%       879              00:02:59                   0
## 228      60.67%       511              00:02:22                0.56
## 229      61.85%       764              00:03:00                   0
## 230      76.92%       275              00:01:01                   0
## 231      32.54%       992              00:03:51                1.18
## 232      30.95%     1,188              00:04:42                   0
## 233      47.44%       737              00:03:37                1.92
## 234      67.76%       241              00:01:49                   0
## 235      60.40%       400              00:01:51                0.67
## 236      70.75%       335              00:00:55                   0
## 237      31.51%     1,013              00:04:57                 8.9
## 238      36.43%       696              00:03:54                0.71
## 239      42.45%       613              00:03:07                   0
## 240      42.34%       484              00:01:56                   0
## 241       0.00%       465              00:03:43               18.98
## 242      26.67%       546              00:03:40                   0
## 243      28.89%     1,226              00:06:49                2.96
## 244      30.83%       970              00:05:35                6.02
## 245      33.33%       840              00:04:39                0.76
## 246      61.07%       324              00:01:26                   0
## 247      68.46%       297              00:01:20                   0
## 248      29.46%     1,000              00:05:36                0.78
## 249      62.20%       397              00:01:27                0.79
## 250      60.80%       396              00:01:44                   0
##     Transactions Revenue Quantity.Sold
## 1            394  83,244           482
## 2          1,347 203,552         2,402
## 3            477  94,282           599
## 4            311  54,971           415
## 5          1,138 167,113         1,987
## 6            486 103,001           607
## 7            601 128,552           777
## 8            730  98,161         1,360
## 9            657 126,137           981
## 10           531  96,195           843
## 11           225  47,724           317
## 12           622  95,367         1,150
## 13           471  58,744           819
## 14           253  55,954           377
## 15           218  57,597           343
## 16             0       0             0
## 17           294  63,161           500
## 18           268  60,862           419
## 19           279  31,663           489
## 20           341  54,626           742
## 21           156  30,842           261
## 22           322  47,867           678
## 23           183  32,795           325
## 24           272  43,561           530
## 25            88  18,327           144
## 26           364  42,734           635
## 27           190  27,580           341
## 28           204  31,686           374
## 29           117  24,924           228
## 30            67   9,358           112
## 31           208  24,097           356
## 32           136  27,026           165
## 33            85  13,776           131
## 34           181  30,487           290
## 35           223  35,916           442
## 36            91  13,946           122
## 37           185  28,137           318
## 38           185  26,227           319
## 39           188  26,814           315
## 40           128  17,581           173
## 41           203  27,902           316
## 42            28   4,005            36
## 43            18   3,076            22
## 44            84  15,552           116
## 45            59   8,527            84
## 46            18   3,036            29
## 47             2     290             2
## 48            24   4,950            37
## 49            49   8,708            60
## 50           144  18,304           237
## 51            42   5,084            56
## 52           113  17,267           216
## 53            89  13,951           182
## 54            49   7,434            68
## 55            68   7,729           132
## 56            58  12,242            72
## 57            56   6,244           129
## 58            45   9,499            69
## 59            61  15,567            96
## 60            85  12,214           170
## 61            62   8,954           120
## 62            63  13,965           118
## 63            50  11,723            79
## 64             0       0             0
## 65            23   3,520            38
## 66            38   7,173            84
## 67            40   7,060            82
## 68           110  13,430           179
## 69           137  22,287           181
## 70             7   1,298             8
## 71             3     480             3
## 72            44   6,783            87
## 73            16   3,014            19
## 74             5     776             5
## 75             5     620             6
## 76             6   1,157            22
## 77            10   1,576            17
## 78             0       0             0
## 79             6   1,217            14
## 80             5     623             9
## 81             7   1,320            12
## 82             0       0             0
## 83             1     111             5
## 84             0       0             0
## 85             5   1,139            14
## 86            20   2,666            26
## 87             8   1,059            10
## 88             4     644             8
## 89            14   2,382            28
## 90             4   1,132             9
## 91            10   2,262            22
## 92             7   1,280            12
## 93            37   4,221            56
## 94             3     333             5
## 95             7   1,242            12
## 96            11   1,863            17
## 97            11   1,515            20
## 98             5   1,005             9
## 99           783 130,744         1,927
## 100            3     277             7
## 101            0       0             0
## 102           11   2,198            23
## 103            0       0             0
## 104            5     644             5
## 105           27   3,759            43
## 106           57   7,728           117
## 107          728 112,265         1,504
## 108            7   1,331             7
## 109            4     489             5
## 110            0       0             0
## 111            2     697             4
## 112           14   1,758            25
## 113           10   1,416            23
## 114           10   1,434            16
## 115          566 103,253         1,430
## 116            4     793             6
## 117            9   1,706            11
## 118           10   1,129            16
## 119            4     659             8
## 120            2     301             5
## 121           16   1,598            27
## 122           26   4,120            52
## 123          230  48,328           532
## 124            0       0             0
## 125          364  58,819           739
## 126            0       0             0
## 127           41   5,550            72
## 128          269  51,587           612
## 129            2     340             2
## 130            4     375             5
## 131           12   1,717            20
## 132            8   1,661            24
## 133           10   1,176            13
## 134            2     370             2
## 135            0       0             0
## 136          252  47,532           488
## 137            0       0             0
## 138           36   5,164            76
## 139            6     972            12
## 140          155  31,855           361
## 141          346  63,057           829
## 142            2     623             2
## 143          257  66,600           397
## 144            0       0             0
## 145          210  38,728           329
## 146            0       0             0
## 147            4     880             4
## 148            6     897            10
## 149            4     773             4
## 150            1     103             1
## 151            2     363             4
## 152            5     541             8
## 153          175  44,790           259
## 154            3     217             6
## 155            2     238             4
## 156           16   2,079            18
## 157            5     792            17
## 158           37   9,673            87
## 159            4     507             6
## 160          161  31,449           231
## 161            1     110             1
## 162            4     586             5
## 163            0       0             0
## 164            3     378             6
## 165            2     266             2
## 166            4     886             4
## 167            2     367             3
## 168            4     318             5
## 169            1      55             1
## 170          223  52,544           353
## 171            0       0             0
## 172            1      97             1
## 173            9   1,307            10
## 174            0       0             0
## 175            0       0             0
## 176            0       0             0
## 177            2     348             2
## 178          102  20,547           174
## 179            2     224             5
## 180            3     846             3
## 181            2     153             3
## 182            1      42             1
## 183            0       0             0
## 184            1      70             1
## 185            4   1,769            13
## 186           91  21,843           169
## 187            4     779             5
## 188            1      80             2
## 189            1     280             5
## 190            2     334             2
## 191           18   2,977            31
## 192            8   1,224            18
## 193            0       0             0
## 194            0       0             0
## 195            0       0             0
## 196           78  20,242           123
## 197           24   5,603            68
## 198            0       0             0
## 199            5     798             8
## 200            0       0             0
## 201            0       0             0
## 202           94  16,933           130
## 203           13   2,672            13
## 204            1     242             1
## 205           70  14,964            98
## 206            5     456             6
## 207           54  15,128           101
## 208           19   4,106            47
## 209            0       0             0
## 210            2     503             2
## 211            2     343             2
## 212            0       0             0
## 213           67  15,358           110
## 214            3     439             7
## 215            3     450            10
## 216            0       0             0
## 217            0       0             0
## 218            0       0             0
## 219            6   1,698             8
## 220            0       0             0
## 221           13   2,081            39
## 222            1     195             1
## 223            7   1,995            15
## 224            0       0             0
## 225            0       0             0
## 226           14   3,796            23
## 227            0       0             0
## 228            1      81             1
## 229            0       0             0
## 230            0       0             0
## 231            2   1,558            22
## 232            0       0             0
## 233            3     460            11
## 234            0       0             0
## 235            1     160             1
## 236            0       0             0
## 237           13   2,590            21
## 238            1      47             1
## 239            0       0             0
## 240            0       0             0
## 241           26   5,908            42
## 242            0       0             0
## 243            4   2,111             5
## 244            8   1,506            14
## 245            1     130             1
## 246            0       0             0
## 247            0       0             0
## 248            1      81             1
## 249            1      77             1
## 250            0       0             0
\end{verbatim}

\subsection{Step 2 : Explore Dataset}\label{step-2-explore-dataset}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    250 obs. of  13 variables:
##  $ Source...Medium      : chr  "A" "A" "A" "A" ...
##  $ Year                 : int  2019 2020 2019 2019 2020 2019 2020 2020 2020 2020 ...
##  $ Month.of.the.year    : int  11 5 10 9 6 12 1 7 2 3 ...
##  $ Users                : chr  "126,870" "120,625" "123,361" "106,551" ...
##  $ New.Users            : chr  "104,020" "98,574" "104,308" "88,428" ...
##  $ Sessions             : chr  "194,667" "194,114" "181,175" "170,329" ...
##  $ Bounce.Rate          : chr  "71.59%" "64.56%" "41.91%" "75.92%" ...
##  $ Pageviews            : chr  "455,159" "559,509" "368,907" "368,803" ...
##  $ Avg..Session.Duration: chr  "00:01:11" "00:01:32" "00:01:05" "00:01:01" ...
##  $ Conversion.Rate....  : chr  "0.2" "0.69" "0.26" "0.18" ...
##  $ Transactions         : chr  "394" "1,347" "477" "311" ...
##  $ Revenue              : chr  "83,244" "203,552" "94,282" "54,971" ...
##  $ Quantity.Sold        : chr  "482" "2,402" "599" "415" ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  Source...Medium         Year      Month.of.the.year    Users          
##  Length:250         Min.   :2019   Min.   : 1.00     Length:250        
##  Class :character   1st Qu.:2019   1st Qu.: 4.00     Class :character  
##  Mode  :character   Median :2020   Median : 6.00     Mode  :character  
##                     Mean   :2020   Mean   : 6.54                       
##                     3rd Qu.:2020   3rd Qu.:10.00                       
##                     Max.   :2020   Max.   :12.00                       
##   New.Users           Sessions         Bounce.Rate         Pageviews        
##  Length:250         Length:250         Length:250         Length:250        
##  Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##                                                                             
##                                                                             
##                                                                             
##  Avg..Session.Duration Conversion.Rate.... Transactions      
##  Length:250            Length:250          Length:250        
##  Class :character      Class :character    Class :character  
##  Mode  :character      Mode  :character    Mode  :character  
##                                                              
##                                                              
##                                                              
##    Revenue          Quantity.Sold     
##  Length:250         Length:250        
##  Class :character   Class :character  
##  Mode  :character   Mode  :character  
##                                       
##                                       
## 
\end{verbatim}

Note: - Có 13 cột, 250 dòng , df {[}6 x 13{]}

\begin{itemize}
\item
  có sự ko nhất quán về kiểu dữ liệu ở User, New.Users , Sessions,
  Bounce.Rate , Pageviews , : Avg..Session.Duration,
  Conversion.Rate,Transactions ,Revenue , Quantity.Sold ( hiện số những
  kiểu dữ liệu lại là kí tự )
\item
  ko có bị null data nhưng có dữ liệu là số 0
\end{itemize}

\subsection{Step 3 : Pre-process, cleaning
data}\label{step-3-pre-process-cleaning-data}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cols\_to\_clean }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Users"}\NormalTok{, }\StringTok{"New.Users"}\NormalTok{, }\StringTok{"Sessions"}\NormalTok{, }\StringTok{"Pageviews"}\NormalTok{, }
                   \StringTok{"Transactions"}\NormalTok{, }\StringTok{"Revenue"}\NormalTok{, }\StringTok{"Quantity.Sold"}\NormalTok{)}

\NormalTok{data[cols\_to\_clean] }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(data[cols\_to\_clean], }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{gsub}\NormalTok{(}\StringTok{","}\NormalTok{, }\StringTok{""}\NormalTok{, x)))}
\end{Highlighting}
\end{Shaded}

\subsection{Step 4 : Summary data}\label{step-4-summary-data}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{revenue\_summary }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(}\AttributeTok{Source =} \StringTok{\textasciigrave{}}\AttributeTok{Source...Medium}\StringTok{\textasciigrave{}}\NormalTok{, Year) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{TotalRevenue =} \FunctionTok{sum}\NormalTok{(Revenue, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(Year, }\FunctionTok{desc}\NormalTok{(TotalRevenue))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'Source'. You can override using the
## `.groups` argument.
\end{verbatim}

\subsection{Step 5 : Filter top 3 traffic source by
year}\label{step-5-filter-top-3-traffic-source-by-year}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top3\_sources }\OtherTok{\textless{}{-}}\NormalTok{ revenue\_summary }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Year) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{slice\_max}\NormalTok{(TotalRevenue, }\AttributeTok{n =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Step 6 : Draw the chart}\label{step-6-draw-the-chart}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(top3\_sources, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(Source, }\SpecialCharTok{{-}}\NormalTok{TotalRevenue), }\AttributeTok{y =}\NormalTok{ TotalRevenue, }\AttributeTok{fill =} \FunctionTok{factor}\NormalTok{(Year))) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{()) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Top 3 Traffic Sources by Revenue per Year"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Traffic Source"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Total Revenue"}\NormalTok{,}
    \AttributeTok{fill =} \StringTok{"Year"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ comma)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{CW-WebData_files/figure-latex/unnamed-chunk-7-1.pdf}}

\subsection{Comment:}\label{comment}

\textbf{Insight:}

As shown in Figure{[}above{]}, Source A consistently generated the
highest revenue in both 2019 and 2020. While the exact source labels are
anonymised, the performance trend indicates that Source A represents a
highly effective channel. Source S and B followed similar upward trends,
contributing significantly to overall revenue in 2020.

\section{Task 1b - Device Usage and
Conversion}\label{task-1b---device-usage-and-conversion}

\subsection{Step 0 : Load libraries}\label{step-0-load-libraries}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\subsection{Step 1 : Load data}\label{step-1-load-data-1}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"../data/Web Analytic\_Dataset.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 250 Columns: 13
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (3): Source / Medium, Bounce Rate, Conversion Rate (%)
## dbl  (2): Year, Month of the year
## num  (7): Users, New Users, Sessions, Pageviews, Transactions, Revenue, Quan...
## time (1): Avg. Session Duration
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{colnames}\NormalTok{(df) }\OtherTok{\textless{}{-}} \FunctionTok{str\_replace\_all}\NormalTok{(}\FunctionTok{colnames}\NormalTok{(df), }\StringTok{" "}\NormalTok{, }\StringTok{"."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Step 2 : Explore dataset}\label{step-2-explore-dataset-1}

\subsection{Step 3 : Pre-process}\label{step-3-pre-process}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{Sessions =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{gsub}\NormalTok{(}\StringTok{","}\NormalTok{, }\StringTok{""}\NormalTok{, Sessions)),}
    \AttributeTok{Transactions =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{gsub}\NormalTok{(}\StringTok{","}\NormalTok{, }\StringTok{""}\NormalTok{, Transactions)),}
    \StringTok{\textasciigrave{}}\AttributeTok{Source./.Medium}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{as.factor}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Source./.Medium}\StringTok{\textasciigrave{}}\NormalTok{),}
    \AttributeTok{conversionRate =} \FunctionTok{as.numeric}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Conversion.Rate.(\%)}\StringTok{\textasciigrave{}}\NormalTok{),}
    \AttributeTok{Month =}\NormalTok{ Month.of.the.year,}
    \AttributeTok{Device =} \StringTok{\textasciigrave{}}\AttributeTok{Source./.Medium}\StringTok{\textasciigrave{}} 
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(conversionRate)) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: There was 1 warning in `mutate()`.
## i In argument: `conversionRate = as.numeric(`Conversion.Rate.(%)`)`.
## Caused by warning:
## ! NAs introduced by coercion
\end{verbatim}

\subsection{Step 4 : Filter}\label{step-4-filter}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summary\_df }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Device, Year, Month) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{Sessions =} \FunctionTok{sum}\NormalTok{(Sessions, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Transactions =} \FunctionTok{sum}\NormalTok{(Transactions, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{ConversionRate =} \FunctionTok{sum}\NormalTok{(Transactions, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(Sessions, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'Device', 'Year'. You can override using
## the `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tính tổng sessions theo Device}
\NormalTok{top\_devices }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Source./.Medium}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{total\_sessions =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{gsub}\NormalTok{(}\StringTok{","}\NormalTok{, }\StringTok{""}\NormalTok{, Sessions)), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(total\_sessions)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{slice\_head}\NormalTok{(}\AttributeTok{n =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pull}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Source./.Medium}\StringTok{\textasciigrave{}}\NormalTok{)}

\CommentTok{\# Lọc lại dữ liệu chỉ lấy top devices}
\NormalTok{df\_filtered }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Source./.Medium}\StringTok{\textasciigrave{}} \SpecialCharTok{\%in\%}\NormalTok{ top\_devices)}

\NormalTok{summary\_df}\SpecialCharTok{$}\NormalTok{ConversionRate }\OtherTok{\textless{}{-}}\NormalTok{ summary\_df}\SpecialCharTok{$}\NormalTok{ConversionRate }\SpecialCharTok{*} \DecValTok{100}  \CommentTok{\# nếu muốn hiển thị theo \%}
\end{Highlighting}
\end{Shaded}

\subsection{Step 5 : Table data}\label{step-5-table-data}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(knitr)}
\FunctionTok{kable}\NormalTok{(}\FunctionTok{head}\NormalTok{(summary\_df, }\DecValTok{12}\NormalTok{), }\AttributeTok{caption =} \StringTok{"Conversion Rate by Device per Year and Month"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrrrr@{}}
\caption{Conversion Rate by Device per Year and Month}\tabularnewline
\toprule\noalign{}
Device & Year & Month & Sessions & Transactions & ConversionRate \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
Device & Year & Month & Sessions & Transactions & ConversionRate \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
A & 2019 & 9 & 170329 & 311 & 0.1825878 \\
A & 2019 & 10 & 181175 & 477 & 0.2632814 \\
A & 2019 & 11 & 194667 & 394 & 0.2023969 \\
A & 2019 & 12 & 142637 & 486 & 0.3407251 \\
A & 2020 & 1 & 133736 & 601 & 0.4493928 \\
A & 2020 & 2 & 125318 & 657 & 0.5242663 \\
A & 2020 & 3 & 110546 & 531 & 0.4803430 \\
A & 2020 & 4 & 104146 & 622 & 0.5972385 \\
A & 2020 & 5 & 194114 & 1347 & 0.6939221 \\
A & 2020 & 6 & 163446 & 1138 & 0.6962544 \\
A & 2020 & 7 & 125423 & 730 & 0.5820304 \\
A & 2020 & 8 & 56931 & 272 & 0.4777713 \\
\end{longtable}

\subsection{Step 6 : Draw chart}\label{step-6-draw-chart}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(summary\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Month, }\AttributeTok{y =}\NormalTok{ ConversionRate, }\AttributeTok{color =}\NormalTok{ Device, }\AttributeTok{group =}\NormalTok{ Device)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size =} \FloatTok{1.2}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Year) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Monthly Conversion Rate per Device (Assumed from Source/Medium)"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Month"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Conversion Rate"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Device"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## i Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{CW-WebData_files/figure-latex/unnamed-chunk-13-1.pdf}}

\end{document}
